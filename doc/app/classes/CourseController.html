<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: CourseController</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">CourseController</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/app/controllers/course_controller_rb.html">
                app/controllers/course_controller.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="ApplicationController.html">
                ApplicationController
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
<a href="CourseController.html">CourseController</a> holds methods to
manage and modify courses - which are known as &#8216;classes&#8217; in the
views. The name classes was not used as it is a key word in ruby and would
result in error / confusion. Each class should be part of a section (group
in the views). This is done so the forums are limited to a sub-set of the
classes involved in the Greenword experiment.
</p>
<p>
Before enrollment is allowed, all courses and sections should be set up and
assigned correctly. This is to ensure students will have the correct
courses to choose from in the sign-up process, and so that they will be
able to see the right forums.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000027">add_to_section</a>&nbsp;&nbsp;
      <a href="#M000028">by_section</a>&nbsp;&nbsp;
      <a href="#M000026">edit</a>&nbsp;&nbsp;
      <a href="#M000024">index</a>&nbsp;&nbsp;
      <a href="#M000025">new</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000027" class="method-detail">
        <a name="M000027"></a>

        <div class="method-heading">
          <a href="#M000027" class="method-signature">
          <span class="method-name">add_to_section</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Used in the ajax manipulation of the courses and the sections. When a
course is dragged over a section, it is assigned to that section.
</p>
<p>
Note the render :update section which is another way to perform ajax
manipulation of the page as a substitute for a standalone .rjs page.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000027-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000027-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/course_controller.rb, line 46</span>
46:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_to_section</span>
47:     <span class="ruby-identifier">course_id</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;-&quot;</span>)[<span class="ruby-value">1</span>]
48:     <span class="ruby-ivar">@course</span> = <span class="ruby-ivar">@semester</span>.<span class="ruby-identifier">courses</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">course_id</span>)
49:     <span class="ruby-ivar">@section</span> = <span class="ruby-ivar">@semester</span>.<span class="ruby-identifier">sections</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value str">&quot;section_id&quot;</span>])
50:     <span class="ruby-ivar">@course</span>.<span class="ruby-identifier">section_id</span> = <span class="ruby-ivar">@section</span>.<span class="ruby-identifier">id</span>
51:     <span class="ruby-ivar">@course</span>.<span class="ruby-identifier">update</span>
52:     <span class="ruby-ivar">@courses</span> = <span class="ruby-ivar">@semester</span>.<span class="ruby-identifier">courses</span>.<span class="ruby-identifier">find_ordered</span>
53:     <span class="ruby-identifier">render</span> <span class="ruby-identifier">:update</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">page</span><span class="ruby-operator">|</span>
54:        <span class="ruby-comment cmt"># page.replace &quot;course-#{course_id}&quot;, :partial =&gt; 'course', :object =&gt; @course</span>
55:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">replace_html</span> <span class="ruby-value str">&quot;courses&quot;</span>, <span class="ruby-identifier">:partial</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'courses'</span>, <span class="ruby-identifier">:object</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@courses</span>
56:        <span class="ruby-identifier">page</span>.<span class="ruby-identifier">visual_effect</span> <span class="ruby-identifier">:highlight</span>, <span class="ruby-node">&quot;course-#{course_id}&quot;</span>
57:     <span class="ruby-keyword kw">end</span>
58:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000028" class="method-detail">
        <a name="M000028"></a>

        <div class="method-heading">
          <a href="#M000028" class="method-signature">
          <span class="method-name">by_section</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Display courses by section
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000028-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000028-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/course_controller.rb, line 61</span>
61:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">by_section</span>
62:     <span class="ruby-ivar">@sections</span> = <span class="ruby-ivar">@semester</span>.<span class="ruby-identifier">sections</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>)
63:      <span class="ruby-comment cmt"># @courses = @semester.courses.find(:all, :order =&gt; &quot;section_id&quot;)</span>
64:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000026" class="method-detail">
        <a name="M000026"></a>

        <div class="method-heading">
          <a href="#M000026" class="method-signature">
          <span class="method-name">edit</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
<a href="CourseController.html#M000026">edit</a> course details like name.
The names are displayed in the signup section of the students
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000026-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000026-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/course_controller.rb, line 31</span>
31:    <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">edit</span>
32:      <span class="ruby-ivar">@course</span> = <span class="ruby-ivar">@semester</span>.<span class="ruby-identifier">courses</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
33:      <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
34:      <span class="ruby-keyword kw">if</span>(<span class="ruby-ivar">@course</span>.<span class="ruby-identifier">update_attributes</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:course</span>]))
35:        <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Course edited&quot;</span>
36:        <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'course'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'index'</span>)
37:      <span class="ruby-keyword kw">else</span>
38:        <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Error in Course Edit&quot;</span>
39:        <span class="ruby-identifier">render</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'edit'</span>
40:      <span class="ruby-keyword kw">end</span>
41:    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000024" class="method-detail">
        <a name="M000024"></a>

        <div class="method-heading">
          <a href="#M000024" class="method-signature">
          <span class="method-name">index</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
display the courses and sections so that courses can be assigned to a
particular section
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000024-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000024-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/course_controller.rb, line 10</span>
10:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">index</span>
11:     <span class="ruby-ivar">@courses</span> = <span class="ruby-ivar">@semester</span>.<span class="ruby-identifier">courses</span>.<span class="ruby-identifier">find_ordered</span>
12:     <span class="ruby-ivar">@sections</span> = <span class="ruby-ivar">@semester</span>.<span class="ruby-identifier">sections</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>)
13:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000025" class="method-detail">
        <a name="M000025"></a>

        <div class="method-heading">
          <a href="#M000025" class="method-signature">
          <span class="method-name">new</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Create a <a href="CourseController.html#M000025">new</a> course and save it
to the model layer. Currently courses are created without an associated
secetion. But for the forum stuff to work correctly, all courses need to be
assigned to a semester. The best way for this to work would be to create a
number of sections (which in this implementation will be 1 section for
every 2 courses) and then create the courses.
</p>
<p>
When creating a <a href="CourseController.html#M000025">new</a> semester
via the copy method, there is an checkbox option to also copy over the old
semesters courses and sections. This would be the recommend method to
create courses if the course names stayed the same (or nearly the same)
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000025-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000025-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/course_controller.rb, line 18</span>
18:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">new</span>
19:      <span class="ruby-ivar">@course</span> = <span class="ruby-constant">Course</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:course</span>])
20:      <span class="ruby-ivar">@course</span>.<span class="ruby-identifier">semester_id</span> = <span class="ruby-ivar">@semester</span>.<span class="ruby-identifier">id</span>
21:      <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
22:      <span class="ruby-ivar">@course</span>.<span class="ruby-identifier">save!</span>     
23:      <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'course'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'index'</span>)
24:      <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;New course created&quot;</span>
25:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>
26:      <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-value str">&quot;Error in Section Creation&quot;</span>
27:      <span class="ruby-identifier">render</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'new'</span>
28:    <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>